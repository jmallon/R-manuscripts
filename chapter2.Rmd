---
#title: "Chapter 2"
#author: "Julie Mallon"
#date: "August 7, 2017"
output: pdf_document
#fontsize: 11pt
bibliography: ch2.bib #C:/Users/Julie/Box Sync/R/Proposal/ch2.bib
csl: the-auk.csl #C:/Users/Julie/Box Sync/R/Proposal/the-auk.csl

---

```{r set environment, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
rm(list=ls())

## Load host-dependent directory environment
winos <- ifelse(grepl("windows", Sys.info()['sysname'], ignore.case=T), 1, 0)
if(winos==1) source("C:/Users/Julie/Box Sync/R/Chapter 1/Scripts/Functions/file_dir_params.R")
if(winos==0) source("~/Box Sync/R/Chapter 1/Scripts/Functions/file_dir_params.R")
#rm(winos)
```

```{r source data and source analyses, include=FALSE}
library(here)
#source(here('Scripts/weather vs feeding.R'))
if(winos==1) load("C:/Users/Julie/Box Sync/R/Chapter 1/Data/stopovers_with_all_weather.robj")
if(winos==0) load("~/Box Sync/R/Chapter 1/Data/stopovers_with_all_weather.robj")

source(paste0(prjfuns, "chapter 1 functions.r"))

pacman::p_load(knitr, captioner, bundesligR, stringr)
library(broman)
library(bibtex)
#write.bib(c('bibtex','lme4','adehabitatLT','ResourceSelection','marcher'), file = "references.bib", append = TRUE, verbose = TRUE)
#bib<-read.bib('references.bib')
#bib$key
```

```{r number tables,include=FALSE}
#tables
table_nums <- captioner::captioner(prefix = "Table")

tab.1_cap <- table_nums(name = "tab_1", 
                        caption = "caption for table 1")

  #inline example  text `r t.ref("tab_1")` more text


t.ref <- function(x) {
  stringr::str_extract(table_nums(x), "[^:]*")
}
```

```{r number figures,include=FALSE}
#figures
fig_nums <- captioner::captioner(prefix = "Figure")

fig.1_cap <- fig_nums(name = "fig_1", 
                        caption = "Map of the 2015 fall migration of 'Leo'. Migration began in Saskatchewan, Canada and ended in Apure, Venezuela 45 days later. Color of left plot indicates daily fat requirements based on estimated body mass and hourly activity rates. Color of right plot indicates fat requirements per 168 km")
#fig.2_cap <- fig_nums(name = "fig_2", 
 #                       caption = "Map of the 2015 fall migration of 'Leo'. Migration began in Saskatchewan, Canada and ended in Apure, Venezuela 45 days later. Color indicates fat requirements per 168 km (number chosen to approximate number of points in figure 1).")
  #inline example  text `r f.ref("fig_1")` more text
f.ref <- function(x) {
  stringr::str_extract(fig_nums(x), "[^:]*")
}

```

#Energetic costs of migration and stopover use by turkey vultures (*Cathartes aura*)


##Abstract
Stopovers are crucial periods of rest and refuel for avian migrants. However, turkey vultures (*Cathartes aura*) do not have predictable access for food during migration and may not use stopovers to feed. It is thought that turkey vultures can complete their migration without feeding because they use energetically efficient soaring flight to migrate. Here, I determine what energetic costs migrations are likely to pose on individual turkey vultures and how stopover behavior and environmental conditions affect these energetic costs. I will also determine the maximum time spent at stopovers theoretically possible for birds of varying body masses and migratory distances. I conclude that some turkey vultures are able to complete migration without using stopovers to refuel, but slow, long distance migrations require stopovers to refuel.


```{r,eval=FALSE,echo=FALSE}
Birds fuel their migrations with fat deposits; yet, birds are physiologically constrained in the amount of fat they can store [@mcwilliams2004flying] and typically need to visit stopovers to refuel during their migration. 
For these species, most of the time spent during migration is spent stopover sites (up to 90%; [@hedenstrom1998fast]. Due to the time investment at stopovers, passerines are estimated to spend two times more energy overall at stopovers than they spend actively migrating [@hedenstrom1998fast; @wikelski2003avian].
                                                                                    Stopovers, however, do not function as opportunities to refuel for all species. For example, the turkey vulture (*Cathartes aura*) does not have access to food and, therefore, cannot stop to feed during at least half of its migration [>3,000 km; @bildstein2006migrating]. This is further evidenced by migrant turkey vultures arriving at their wintering grounds with poor body conditions [@kirk1994body]. Turkey vultures can afford to migrate such distances without refueling because they are soaring migrants, which is an energetically efficient mode of flight that uses only twice the resting BMR [@baudinette1974energy]. For soaring birds, the costs of migration are subsidized by using environmentally available updrafts. 
```



##Introduction

The low energetic costs of soaring allow raptors and other soaring birds to migrate long distances. Flapping flight uses 8 - 30 times the energy of BMR [@newton2007migration] and increases allometrically with body mass, whereas non-flapping flight uses relatively little energy [@baudinette1974energy; @newton2007migration] and does not increase as much with increasing body mass. This is because flapping flight requires wing movement to provide lift and thrust. Soaring and gliding only requires activity in muscles to keep wings outstretched. Soaring uses external energy from updrafts, enabling birds to maintain or gain altitude. Gliding flight propels birds by the transformation of potential energy (i.e. altitude) into kinetic energy (i.e. forward motion). 

Regardless of flight mode, migrating birds need to store fat to fuel migration [@olson1985avian; @blem1976patterns; @newton1969winter]. Energy storage in this manner though, comes at the cost of increased mass. Flight costs are frequently studied using migrants because migrations are extreme flights and can cause considerable changes in flight behavior and physiology in some species [@piersma1998phenotypic]. Body reserves increase flight costs non-linearly because of the energy required for their transportation and maintenance [@pennycuick1989bird]. Increased mass also decreases agility and speed [@witter1994experimental] in some species, making birds more vulnerable to predation [@lind1999reduced]; birds, therefore, should refuel as often as possible instead of carrying extra reserves [@newton2007migration].  

This can be difficult for some species to do because food may not be abundant in the landscapes that they migrate through. Many raptors fast for long periods during migration, which is expected to be because of the low abundance of food resources relative to the density of conspecifics, and the higher energetic demands due to large body mass. Raptors compensate for their higher metabolic rates and the low availability of food by soaring, which reduces the costs of migration.

Obligate soaring birds, such as vultures, have very low energetic requirements associated with movement. Soaring is necessary for vultures to profit from carrion, which is an ephemeral resource, as it is the most efficient way to search on the wing [@ruxton2004obligate]. Having a large body mass is an important aspect of scavenging: with a larger body, vultures can have greater reserves and consume more food in one feeding, in order to deal with fluxes in resource availability. This allows them greater immediate food-storage capacities, improving a bird’s ability to replenish used reserves quickly [@ruxton2004obligate]. BMR decreases with increasing body mass [@lasiewski1967re], which helps promote energy efficiency as well. These adaptations that maximize energy efficiency allow vultures to rely on uncertain food resources, and potentially allow them to complete their migrations without feeding.

Obligate migratory populations of turkey vultures (*Cathartes aura meridionalis*) migrate 13,000 km annually between winter grounds in northern South America and summer grounds in northern North America (Chapter 1 Figure 1). Yet, it is unknown how turkey vultures complete their migrations, energetically. Along most of these routes, it is very unlikely that migrants are stopping to feed on carrion [@bildstein2006migrating]. This is, in part, due to the ephemeral nature of carrion [which typically lasts <48 hours; @houston1985evolutionary; @smith2017spatial] and the amount of time and energy it takes to find and consume carrion. Although turkey vultures do not flock during migration, the abundance of migrants passing through Central America simultaneously can be upwards of 100,000 migrants per day in a given area [@bildstein2006migrating]. If there is carrion available in this system, it is insufficient to sustain even a small fraction of these individuals. It may be possible, however, that migrants feed close to their summer grounds where vulture abundance and competition is lower. 

Like turkey vultures, it is generally assumed that soaring raptors do not feed during migration [@smith1986long]. However, some soaring migrants, like the bald eagle (*Haliaeetus leucocephalus*), are known to feed during stopovers [@restani2000numerical]. This is possible due to the abundance of prey (primarily fish) and the low density of migrating conspecifics. It also may be required to compensate for higher energetic costs as bald eagles use flapping more often than turkey vultures (pers. obs.).

As obligate soaring birds, it is clear that vultures subsidize most of their energetic costs by using environmentally available updrafts. However, updraft availability varies seasonally [@duerr2015flight]. Additionally, migratory drivers vary seasonally as many individuals are time restricted during spring migration in order to get to nesting locations and find their mate. The energetic cost of spring migration may be lower than fall migration, due to migration occurring in a shorter time window; however, if updrafts are not a strong during the spring as the fall, turkey vultures may flap more often and increase their flight costs.

To understand how turkey vultures complete their migrations, energetically, I will calculate the expected energetic cost of migration using telemetry data for individuals in each migratory population (described in chapter 1). I will then calculate the amount of fat deposits an individual would need to carry to complete this migration without feeding and, finally, determine if it is theoretically possible for a vulture to migrate without stopping to refuel. I will also calculate the energetic costs of stopovers, and determine how much extra energy individuals spend while stopped over. Together, these will confirm if the primary function of stopovers by vultures is weather avoidance (Chapter 1). 

##Methods
My methods will be modeled after two publications on the energetics of migrations and stopovers. @smith1986long investigated the theoretical cost of completing a migration for two soaring raptors - Swainson’s Hawk (*Buteo swainsoni*) and Broad Winged Hawk (*B. platypterus*). They computed the energetic cost, per day, of an individual and estimated the mass of fat that would need to be used to sustain the entire migration. Finally, they determined if this starting fat deposit load was feasible for birds to carry if the birds were to migrate without feeding. @wikelski2003avian investigated the energetic costs of a passerine migrant at stopover sites, relative to the energetic costs of migration. They trapped migrating Swainson’s (*Catharus ustulatus*) and hermit (*C. guttatus*) thrushes at stopover sites and determined the rate of metabolism during migratory flights on recaptured birds. 

Although I do not have empirical data on the body mass and fat deposits of individual turkey vultures, I can estimate the energy expenditures of migrant turkey vultures using telemetry data and heart rate data [@mandel2008movement]. Then for several body mass and fat reserve values I can determine if turkey vultures can afford to migrate without feeding. I can also determine if true energetic costs deviates from the basic energetic model used by [@smith1986long] by using data from migratory tracks on: migration distance and duration, flight speed, stopover duration, take-off and landing, and environmental conditions that may elevate metabolic costs. Like @wikelski2003avian, I can then determine if stopovers pose significant energetic costs to turkey vultures relative to the cost of migration, and if so, how long vultures can stopover before needing to refuel to compensate for lost energy stores.


```{r, include=FALSE}
# analyze one track with just migration, and just stopovers
# add in estimates of energy gain per stopover (only stopovers that defintely were feeding)?
# add day specific energy estimates
# heat map of energy expenditure
# estimates of which migrations had mortality
# migration success ~ 
```


```{r,echo=FALSE, include=FALSE}
source(here('../Chapter 2/Energy per hr and per km.R'))
round(sum(mig_metrics$dist)/1000)
library(scales)
```


##Results

Using the energetic model of @smith1986long, I estimated the energy used during migration by starting with some assumed morphological and migration parameters. I used data from the 2015 fall migration of a long distance migrant, “Leo” (*Cathartes aura meridionalis*) (Figure 1). This bird’s summer grounds are in Saskatchewan, Canada, its wintering grounds are in Apure, Venezuela, a distance of ~`r round(sum(mig_metrics$dist)/1000)` km. This migration took `r days` days and had `r unique(subset(focal.mig,stopover==1)$stop.id)%>% length()` stopovers that lasted a cumulative `r subset(focal.mig,stopover==1)$dt %>% sum()/3600` hours.

To determine the basal metabolic rate of a turkey vulture, I used the measured BMR of a black vulture [3.1 W/kg, @larochelle1982temperature]. Black vultures are closely related to turkey vultures and has a similar body mass (black vulture: 1.65 kg; turkey vulture: 1.43kg; Kirk and Gossler 1994). Other sources report body masses of black vultures 1.67-2.36 kg [@larochelle1982temperature] and turkey vultures 1.53-2.59 kg [@hatch1970energy]. The smaller body masses of turkey vultures are associated with the *C. aura aura* race, and the largest body masses are associated with the *C. aura meridionalis* race, so I used a starting body mass of `r kg` kg.

The oxidization of fat produces 39.7 kJ/g [@smith1986long]. Assuming the vultures soars exclusively, the energetic output for each hour of migration is 2 x BMR and for each hour of roosting is equal to 0.8 x daytime BMR [@aschoff1970ruheumsatz]. This may be a overestimate of nighttime BMR because turkey vultures drop their body temperatures up to 2.6°C at night [@hatch1970energy]. I used 1 x BMR for each hour of stopover during the day, assuming that metabolic processes are elevated during the day.

The basal metabolic rate of a `r kg` kg turkey vulture is `r kg*3.1` Watts. Using the hourly metabolic rates based on typical activity patterns (10 hours soaring, 14 hours roosting), the energetic requirement per day is an average `r BMR_kJ*2*10+14*BMR_kJ*0.8` kJ.

Over `r days` days of active migration, the turkey vulture would require `r round(ns)` g of fat deposits to complete its migration, traveling at an average speed of `r round(sum(mig_metrics$dist)/1000)/days/10` km/hour and a daily distance of `r round(sum(mig_metrics$dist)/1000)/days` km. The `r subset(focal.mig,stopover==1)$dt %>% sum()/3600` hour stopover requires an additional `r round(s-ns)` g of fat, assuming its energetic requirements were equivalent to its roosting BMR. This `r s` g of fat represents `r percent(s/(kg*1000))` of the bird’s starting body mass and the bird would arrive at its wintering grounds weighing approximately `r kg-s/1000` kg.

It is physiologically impossible for a vulture to complete a migration an burn `r percent(s/(kg*1000))` of its body mass. Therefore, at least one of its stopovers must have been used to feed. Seven of the first eight days of migration were spent at least partially stopped over, suggesting that the vulture fed at least once during this time (`r f.ref("fig_1")`). Assuming that the body mass of the vulture was `r kg`kg at the end of this stopover, it would only need `r s - sum(mig_metrics$sum_fat[1:8])` g of fat to complete its migration, which represents `r percent((s- sum(mig_metrics$sum_fat[1:8]))/2500)` of its body mass. This could be considered a feasible amount, although likely at the upper limit of its fat store capactiy.


##Discussion and Justification
Currently, there is little known about fat deposition in migrating raptors. Likewise, there is little evidence that raptors stop to refuel during migrations [@spaar1999flight]. @smith1986long estimated that broad-winged hawks and Swainson’s hawks, small diurnal soaring migrants, are physiologically capable of migrating long distances without feeding, but only with significant fat deposits. The authors found that it was feasible for birds to complete 5-6,000 km migrations without feeding, but the fat deposits would consist of approximately 1/4 an individual’s body mass (Swainson’s Hawk: 200g of 800g; Broad Winged Hawk: 125g of 425g). 

However, some populations of Swainson’s hawks complete the longest migration over land among raptors [up to 9000 km; @bildstein2006migrating]. Although many passerines carry large fat stores [@nisbet1963weight], there may be a limit on the amount of fat a raptor can carry [approximately ~20% of body mass; @bildstein2006migrating]. For a Swainson’s hawk to travel further than 5,000 km, it would require one or more stopovers for refueling. This is confirmed by @kochert2011migration, who found Swainson’s hawks stopover frequently and for long periods of time (> 9 days), which is consistent with stopovers used by other species to refuel.

Calculated metabolic rates could be overestimated. @prinzinger2002energy found that metabolic rates estimated from allometric equations in the literature overestimated the metabolic rates of non-migratory griffon vultures (*Gyps fulvus*). They also found that fasting further decreased metabolic rates 27-35%. This suggests that turkey vultures may be able to migrate on smaller fat deposits than I’ve calculated. 

The migration I used as an example is from one of the longest distance migratory populations of turkey vulture. Therefore, it can be assumed that few vultures would require additional energy to complete their migration. `r s` g of fat is not very much fat to migrate `r round(sum(mig_metrics$dist)/1000)` km in `r days` days. But this is a burden for turkey vultures, which have adapted to have a very light body mass relative to their wingspan, and therefore, a small wing loading to take advantage of weak updrafts [@hedenstrom1993migration]. This is further evident when comparing the body mass of to other raptors with similar wingspans, like the bald eagle (*Haliaeetus leucocephalus*). Bald eagles have a wingspan of 1.68-2.44 m and a body mass of 3-6 kg [@duncan1990identification] and a wing loading of 80.94 N/m2 [@kerlinger1989flight], roughly twice that of a turkey vulture. A turkey vulture with a body mass of 1.78 kg has a wingspan of 1.71 m and a wing loading of 40.6 N/m^2 [@houston1988competition; @grilli2017wing]. Therefore, determining whether fat deposits >20% of body mass is physiological possible for turkey vultures requires further research.

@wikelski2003avian calculated the amount of energy spent by Swainson’s and hermit thrushes by migrating and at stopovers. Due to metabolic activity and local foraging movements, the total energy spent at stopovers was ~70% of the energy spent during the entire migration. In contrast, I found that the cost of five stopovers for turkey vultures was  `r percent((1-ns/s))` of the entire migratory cost. Upon further analyses, these costs could increase if activity levels are high during stopovers. Regardless, the costs of stopovers relative to migration will definitely be much less than the cost found for thrushes and other passerienes [@wikelski2003avian].

All of these calculations of metabolic rate assume migration and stopovers occur during ambient temperatures that are not going to increase metabolic rate. I previously determined that stopovers are primarily used in response to weather conditions. Although turkey vultures tolerate a wide range of climatic conditions, some of the weather conditions during stopovers that prevent the formation of updrafts may increase metabolic rate (e.g. low temperatures, precipitation, and terrain roughness [@mandel2008movement]). It is necessary to use environmental data associated with the turkey vulture migratory tracks to determine whether the equation underestimates the metabolic cost of migrations and stopovers.


<br><br>
```{r,echo=FALSE,warning=FALSE,message=FALSE, eval= FALSE}
##Tables
#`r tab.1_cap`  
#add in figs of migration success vs % body mass and mig success vs % stopover time, as a function of body mass (or fat mass)
```

<P style="page-break-before: always">
##Figures

<br><br>

```{r,echo=FALSE,warning=FALSE,message=FALSE,fig.height=5,fig.width=5.2}
library(scales)
latlimits <- c(8, 52) 
longlimits <- c(-105, -67) 

c1<-seq_gradient_pal("#4575b4", "#fc8d59")(seq(0,1,length.out=23))[1:3]
c2<-seq_gradient_pal("#4575b4", "#fc8d59")(seq(0,1,length.out=23))[4:23]
c3<-c(c1,c2,seq_gradient_pal("#fc8d59", "#d73027")(seq(0,1,length.out=44))[2:44])


map1<-ggplot() + 
  geom_polygon(data = americas.df, aes(x = long, y = lat,group=group),fill="grey90") +
  scale_y_continuous(breaks = (0:6) * 10,
                     labels = c("0ºN", "10ºN", "20ºN","30ºN", "40ºN", "50ºN", "60ºN")) +
  scale_x_continuous(breaks = (-11:-6) * 10,
                     labels = c("110ºW", "100ºW", "90ºW","80ºW", "70ºW", "60ºW"))+ 
  labs(y="",x="")+
  coord_map("azequalarea", orientation = c(0, -90, 0))+
  geom_point(data=mig_metrics,aes(x=X,y=Y, color=as.integer(sum_fat)),size=2,alpha=0.5)+  
  #scale_color_gradient2(high = "#d7191c",mid="#fdae61",low = "#2c7bb6",midpoint = 15)+
  scale_colour_gradientn(colours = c( c2),guide_legend(title="Fat (g) used \n per day"))+

  theme(panel.background = element_rect(fill = "white", colour = "grey"), 
        panel.grid.major = element_line(colour = "grey90"),
        panel.grid.minor = element_blank(),
        axis.ticks = element_blank(), 
        axis.text.x = element_text (size = 10, vjust = 0), 
        axis.text.y = element_text (size = 10, hjust = 1.3),
        legend.position=c(.88, .5)) + 
  coord_cartesian(xlim = longlimits, ylim = latlimits)+ggtitle("Daily Energy Use") 
```

 <br><br>
```{r,echo=FALSE,warning=FALSE,message=FALSE,fig.width=8,fig.height=5}
map2<-ggplot() + 
  geom_polygon(data = americas.df, aes(x = long, y = lat,group=group),fill="grey90") +
  scale_y_continuous(breaks = (0:6) * 10,
                     labels = c("0ºN", "10ºN", "20ºN","30ºN", "40ºN", "50ºN", "60ºN")) +
  scale_x_continuous(breaks = (-11:-6) * 10,
                     labels = c( "110ºW", "100ºW", "90ºW","80ºW", "70ºW", "60ºW"))+ 
  labs(y="",x="")+
  coord_map("azequalarea", orientation = c(0, -90, 0))+
  geom_point(data=km10.df,aes(x=long,y=lat, color=as.integer(step_fat)),size=2,alpha=0.9)+  
  #scale_color_gradient2(high = "#d7191c",mid="#fdae61",low = "#2c7bb6",midpoint = 15)+
  scale_colour_gradientn(colours = c3,  guide_legend(title="Fat (g) used \n per step \n (168 km)"))+

  theme(panel.background = element_rect(fill = "white", colour = "grey"), 
        panel.grid.major = element_line(colour = "grey90"),
        panel.grid.minor = element_blank(),
        axis.ticks = element_blank(), 
        axis.text.x = element_text (size = 10, vjust = 0), 
        axis.text.y = element_text (size = 10, hjust = 1.3),
        legend.position = c(0.88,0.5)) + 
  coord_cartesian(xlim = longlimits, ylim = latlimits) +ggtitle("Energy use per 168 km")

multiplot(map1,map2, cols=2)
```


`r fig.1_cap`  
</P>

```{r theoretical results distance and time, echo=FALSE,eval=FALSE}

#diti<-expand.grid(km=seq(500,8000,250),days=seq(10,50,5))
kg2.5<-data.frame(day=seq(1,35,1))
kg2.5<-data.frame(kg2.5,km=kg2.5$day*250,pfat=kg2.5$day*(25/35)/100)
#kg2<-data.frame(day=seq(1,28,1))
#kg2<-data.frame(kgs,km=kgs$day*250,pfat=kgs$day*(25/28))
mig_metrics<-mig_metrics %>% 
  mutate(day=yday-270,sumdist=cumsum(dist),total_fat=cumsum(sum_fat),p_fat=cumsum(sum_fat)/2500)
kg2.5<-merge(kg2.5,mig_metrics,by="day",all.y=T)
ggplot(kg2.5,aes(x=km,y=pfat))+geom_point()+geom_line(aes(x=sumdist/1000,y=p_fat))+geom_hline(yintercept=0.25)

ggplot(kg2.5,aes(x=day,y=pfat))+geom_point()+geom_line(aes(x=day,y=p_fat))+geom_hline(yintercept=0.25)


```


